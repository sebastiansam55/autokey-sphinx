
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction &#8212; AutoKey 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>This page contains some script examples to demonstrate the capabilities
of AutoKey’s scripting service.</p>
<p>For specific details on the custom functions available to AutoKey
scripts, see the <a class="reference external" href="https://autokey.github.io">API reference</a>.</p>
</div>
<div class="section" id="porting-your-scripts-from-python-2">
<h1>Porting your scripts from Python 2<a class="headerlink" href="#porting-your-scripts-from-python-2" title="Permalink to this headline">¶</a></h1>
<p>Changes were made to source code to keep the scripting API stable.
<code class="docutils literal notranslate"><span class="pre">system.exec_command()</span></code> returns a string. But if you use functions
from the standard library you will have to fix that, as your script runs
on a Python 3 interpreter. For example, expect subprocess.check_output()
to return a bytes object.</p>
<p><a class="reference external" href="http://docs.python.org/dev/library/2to3.html">2to3</a> can be used to
do automatically translate source code.</p>
<p>Some guides on porting code to Python 3: - <a class="reference external" href="http://python3porting.com/">http://python3porting.com/</a> -
<a class="reference external" href="http://diveintopython3.problemsolving.io/porting-code-to-python-3-with-2to3.html">http://diveintopython3.problemsolving.io/porting-code-to-python-3-with-2to3.html</a></p>
<div class="section" id="basic-scripts">
<h2>Basic Scripts<a class="headerlink" href="#basic-scripts" title="Permalink to this headline">¶</a></h2>
<p>Jump to [[Scripting#advanced-scripts]]</p>
<div class="section" id="display-active-window-information">
<h3>Display Active Window Information<a class="headerlink" href="#display-active-window-information" title="Permalink to this headline">¶</a></h3>
<p>Displays the information of the active window after 2 seconds</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">winTitle</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">winClass</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_class</span><span class="p">()</span>
<span class="n">dialog</span><span class="o">.</span><span class="n">info_dialog</span><span class="p">(</span><span class="s2">&quot;Window information&quot;</span><span class="p">,</span> <span class="s2">&quot;Active window information:</span><span class="se">\\</span><span class="s2">nTitle: &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\\</span><span class="s2">nClass: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">winTitle</span><span class="p">,</span> <span class="n">winClass</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="using-dates-in-scripts">
<h3>Using Dates in Scripts<a class="headerlink" href="#using-dates-in-scripts" title="Permalink to this headline">¶</a></h3>
<p>Users frequently need to use the date or time in a script.</p>
<p>The easiest way to get and process a date is by using the Python time or
datetime modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;date %Y:%m:</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>If you need a specific time other than “now”, Python will be happy to
oblige, but setting that up is a separate (purely Python) topic with
many options. (See links at end.)</p>
<p>You can also do things like run the system date command.</p>
<p>This script uses the simplified system.exec_command() function to
execute the Unix date program, get the output, and send it via keyboard
output</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>or, with more options</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">commandstr</span><span class="o">=</span><span class="s2">&quot;date &quot;</span><span class="o">+%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">d</span><span class="s2">&quot; --date=&quot;</span><span class="nb">next</span> <span class="n">sun</span><span class="s2">&quot;&quot;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">commandstr</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p>but this creates another process and makes your script dependent on the
behavior of the external command with respect to both its output format
and any error conditions it may generate.</p>
<div class="section" id="background">
<h4>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h4>
<p>Time itself is stored in binary format (from man clock_gettime(3)):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">All</span>  <span class="n">implementations</span>  <span class="n">support</span>  <span class="n">the</span> <span class="n">system</span><span class="o">-</span><span class="n">wide</span> <span class="n">real</span><span class="o">-</span><span class="n">time</span> <span class="n">clock</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">identified</span> <span class="n">by</span> <span class="n">CLOCK_REALTIME</span><span class="o">.</span>  <span class="n">Its</span> <span class="n">time</span> <span class="n">represents</span>
<span class="n">seconds</span> <span class="ow">and</span> <span class="n">nanoseconds</span> <span class="n">since</span> <span class="n">the</span> <span class="n">Epoch</span><span class="o">.</span>
</pre></div>
</div>
<p>Since this is essentially a really big integer, it is a handy form to
use for calculations involving time. The Linux <em>date</em> command (and the
Python <em>strftime()</em> function) understands this format and will happily
convert from and to various other formats - probably using the same or a
very similar <em>strftime</em> utility.</p>
<p>See: <a class="reference external" href="https://docs.python.org/3/library/datetime.html">datetime</a>,
<a class="reference external" href="https://docs.python.org/3/library/time.html#module-time">time</a></p>
<p>for all the gory details.</p>
</div>
</div>
<div class="section" id="list-menu">
<h3>List Menu<a class="headerlink" href="#list-menu" title="Permalink to this headline">¶</a></h3>
<p>This script shows a simple list menu, grabs the chosen option and sends
it via keyboard output.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;something&quot;</span><span class="p">,</span> <span class="s2">&quot;something else&quot;</span><span class="p">,</span> <span class="s2">&quot;a third thing&quot;</span><span class="p">]</span>
<span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span>
<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;You chose &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="x-selection">
<h3>X Selection<a class="headerlink" href="#x-selection" title="Permalink to this headline">¶</a></h3>
<p>This script grabs the current mouse selection, then erases it, and
inserts it again as part of a phrase.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_key</span><span class="p">(</span><span class="s2">&quot;&lt;delete&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;The text </span><span class="si">%s</span><span class="s2"> was here previously&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="persistent-value">
<h3>Persistent Value<a class="headerlink" href="#persistent-value" title="Permalink to this headline">¶</a></h3>
<p>This script demonstrates ‘remembering’ a value in the store between
separate invocations of the script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>if not store.has_key(&quot;runs&quot;):
    # Create the value on the first run of the script
    store.set_value(&quot;runs&quot;, 1)
else:
    # Otherwise, get the current value and increment it
    cur = store.get_value(&quot;runs&quot;)
    store.set_value(&quot;runs&quot;, cur + 1)

    keyboard.send_keys(&quot;I&#39;ve been run %d times!&quot; % store.get_value(&quot;runs&quot;)) ```
</pre></div>
</div>
</div>
<div class="section" id="create-new-abbreviation">
<h3>Create new abbreviation<a class="headerlink" href="#create-new-abbreviation" title="Permalink to this headline">¶</a></h3>
<p>This script creates a new phrase with an associated abbreviation from
the current contents of the X mouse selection (although you could easily
change it to use the clipboard instead by using
clipboard.get_clipboard()).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The sleep seems to be necessary to avoid lockups</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">contents</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="n">retCode</span><span class="p">,</span> <span class="n">abbr</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">input_dialog</span><span class="p">(</span><span class="s2">&quot;New Abbreviation&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose an abbreviation for the new phrase&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">contents</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_folder</span><span class="p">(</span><span class="s2">&quot;My Phrases&quot;</span><span class="p">)</span>
        <span class="n">engine</span><span class="o">.</span><span class="n">create_abbreviation</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">abbr</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-new-phrase">
<h3>Create new phrase<a class="headerlink" href="#create-new-phrase" title="Permalink to this headline">¶</a></h3>
<p>This is similar to the above script, but just creates the phrase without
an abbreviation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The sleep seems to be necessary to avoid lockups</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">contents</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">contents</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_folder</span><span class="p">(</span><span class="s2">&quot;My Phrases&quot;</span><span class="p">)</span>
    <span class="n">engine</span><span class="o">.</span><span class="n">create_phrase</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="start-external-scripts">
<h3>Start external scripts<a class="headerlink" href="#start-external-scripts" title="Permalink to this headline">¶</a></h3>
<p>In case you’ve some bash-scripts or just want to start a program with
shortcuts To start a script</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">,</span> <span class="s2">&quot;/home/foobar/bin/startfooscript.sh&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>To start a program with wine.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;wine&quot;</span><span class="p">,</span> <span class="s2">&quot;/home/foobar/wine/program/some.exe&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="advanced-scripts">
<h1>Advanced Scripts<a class="headerlink" href="#advanced-scripts" title="Permalink to this headline">¶</a></h1>
<p>This page contains user contributed scripts to demonstrate the
<strong>advanced</strong> capabilities of AutoKey’s scripting service.</p>
<p>Feel free to use the scripts presented for your own purpose. However, if
you significantly modify them or come up with something new as a result
of using them please post them into our forums so one of the wiki
moderators can install them here for all to benefit.</p>
<p>All submitted scripts are publicly licensed as <a class="reference external" href="http://www.gnu.org/licenses/gpl.html">GNU GPL
v3</a></p>
<p>For specific details on the custom functions available to AutoKey
scripts, see the <a class="reference external" href="https://autokey.github.io">API reference</a>.</p>
<p><strong>Discovered at</strong>: <a class="reference external" href="http://www.linuxjournal.com/content/autokey-desktop-automation-utility-linux">Linux
Journal</a></p>
<p><strong>Author</strong>: <a class="reference external" href="http://www.linuxjournal.com/users/mike-diehl">Mike
Diehl</a></p>
<p><strong>Description</strong>: This Autokey script takes a highlighted url from any
program and triggers a selection of browsers from which you can choose
to load the page.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;konqueror&quot;</span><span class="p">,</span> <span class="s2">&quot;firefox&quot;</span><span class="p">,</span> <span class="s2">&quot;chrome&quot;</span><span class="p">]</span>
<span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span>
<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
  <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="http://www.bowierocks.com">Itscool - Al</a></p>
<p><strong>Description</strong>: I created this Autokey script to help me manage the
drinking of health potions. The game lacks a mechanism to quickly imbibe
a potion without some difficulty. It is far easier to hit one key that
does it for you. In the case of this script, you are also taken back to
safe zone if you are out of health potions. All you have to do is make
sure you have pot in all of your slots. It will work even if you don’t
have pot in all of the slots. For use with the flash client at <a class="reference external" href="http://www.realmofthemadgod.com">Realm of
the Mad God</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">store</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;heal&quot;</span><span class="p">):</span>
<span class="c1"># set the key &#39;persistant variable&#39; if we don’t have it already</span>
<span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;heal&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pot</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;heal&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">pot</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
  <span class="c1"># also send us back to the nexus</span>
  <span class="n">pot</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">keyboard</span><span class="o">.</span><span class="n">send_key</span><span class="p">(</span><span class="s2">&quot;&lt;f5&gt;&quot;</span><span class="p">)</span>

<span class="c1">#do the pot thing</span>
<span class="n">output</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_key</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="c1">#increment the pot</span>

<span class="n">pot</span> <span class="o">=</span> <span class="n">pot</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;heal&quot;</span><span class="p">,</span><span class="n">pot</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="http://www.bowierocks.com">Itscool - Al</a></p>
<p><strong>Description</strong>: I created this Autokey script to do two things. 1)
Generate a randomized shout message to gain assistance and 2) drink a
manna pot from one of the bottom four inventory slots. For use with the
flash client at <a class="reference external" href="http://www.realmofthemadgod.com">Realm of the Mad
God</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="n">announcement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OMG&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;DARN&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;OH BOY&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;COME HERE&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;TP ME&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;MESHUGANA&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;OY&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">declaration</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;I could seriously use some help here&quot;</span><span class="p">,</span><span class="s2">&quot;The devs must be crazy&quot;</span><span class="p">,</span><span class="s2">&quot;How many minions did Oryx say he had to feed?&quot;</span><span class="p">,</span><span class="s2">&quot;Dodge bullets? Sure. But this&quot;</span><span class="p">,</span><span class="s2">&quot;MONSTERS&quot;</span><span class="p">]</span>
<span class="n">expletives</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;!&quot;</span><span class="p">,</span><span class="s2">&quot;!!&quot;</span><span class="p">,</span><span class="s2">&quot;!!!&quot;</span><span class="p">,</span><span class="s2">&quot;!!!!1&quot;</span><span class="p">,</span><span class="s2">&quot;!!!1!&quot;</span><span class="p">,</span><span class="s2">&quot;!!1!1!&quot;</span><span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">store</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;mana&quot;</span><span class="p">):</span>
    <span class="c1"># set the key &#39;persistant variable&#39; if we don&#39;t have it already</span>
    <span class="c1"># or if the value is greater than 8 reset it to 5</span>
    <span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;mana&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">mana</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;mana&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">mana</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
    <span class="n">mana</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">part1</span> <span class="o">=</span> <span class="n">announcement</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">announcement</span><span class="p">))]</span>
<span class="n">part2</span> <span class="o">=</span> <span class="n">declaration</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">declaration</span><span class="p">))]</span>

<span class="k">if</span> <span class="n">part1</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="n">part1</span> <span class="o">=</span> <span class="n">part1</span> <span class="o">+</span> <span class="n">expletives</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">expletives</span><span class="p">))]</span>
<span class="k">if</span> <span class="n">part2</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="n">part2</span> <span class="o">=</span> <span class="n">part2</span> <span class="o">+</span> <span class="n">expletives</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">expletives</span><span class="p">))]</span>

<span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;/yell &quot;</span> <span class="o">+</span> <span class="n">part1</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">part2</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1">#do the mana thing</span>
<span class="n">output</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mana</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_key</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="c1">#increment the mana</span>
<span class="n">mana</span> <span class="o">=</span> <span class="n">mana</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;mana&quot;</span><span class="p">,</span><span class="n">mana</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="http://www.bowierocks.com">Itscool - Al</a></p>
<p><strong>Description</strong>: I created this Autokey script will help you manage
drinking health potions in the top four inventory slots. Additionally
it’ll generate a random yell asking for some type of healing support.
For use with the flash client at <a class="reference external" href="http://www.realmofthemadgod.com">Realm of the Mad
God</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="n">announcement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HELP&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;HP&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;HEAL&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;MEDIC&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;DR. WHO&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;1-800-PRIEST&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">declaration</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;I could use some professional help here&quot;</span><span class="p">,</span><span class="s2">&quot;Anyone in the businesses of hp&quot;</span><span class="p">,</span><span class="s2">&quot;Bring lots of that RED STUFF in a jar&quot;</span><span class="p">,</span><span class="s2">&quot;I don&#39;t wanna die&quot;</span><span class="p">,</span><span class="s2">&quot;Mommy&quot;</span><span class="p">,</span><span class="s2">&quot;You can leave a msg at GHOSTBUSTERS&quot;</span><span class="p">,</span><span class="s2">&quot;I&#39;m going to meet the maker&quot;</span><span class="p">,</span><span class="s2">&quot;Great, I&#39;m another Father Dowling Mystery&quot;</span><span class="p">,</span><span class="s2">&quot;Agatha Christi?! Posh&quot;</span><span class="p">,</span><span class="s2">&quot;Should&#39;ve listened to Momma&quot;</span><span class="p">,</span><span class="s2">&quot;I don&#39;t want this chocolate&quot;</span><span class="p">,</span><span class="s2">&quot;...&quot;</span><span class="p">]</span>
<span class="n">expletives</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;!&quot;</span><span class="p">,</span><span class="s2">&quot;!!&quot;</span><span class="p">,</span><span class="s2">&quot;!!!&quot;</span><span class="p">,</span><span class="s2">&quot;!!!!1&quot;</span><span class="p">,</span><span class="s2">&quot;!!!1!&quot;</span><span class="p">,</span><span class="s2">&quot;!!1!1!&quot;</span><span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">store</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;pot&quot;</span><span class="p">):</span>
    <span class="c1"># set the key &#39;persistant variable&#39; if we don&#39;t have it already</span>
    <span class="c1"># or if the value is greater than 4 reset it to 1</span>
    <span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;pot&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pot</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;pot&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">pot</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">pot</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">part1</span> <span class="o">=</span> <span class="n">announcement</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">announcement</span><span class="p">))]</span>
<span class="n">part2</span> <span class="o">=</span> <span class="n">declaration</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">declaration</span><span class="p">))]</span>

<span class="k">if</span> <span class="n">part1</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="n">part1</span> <span class="o">=</span> <span class="n">part1</span> <span class="o">+</span> <span class="n">expletives</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">expletives</span><span class="p">))]</span>

<span class="k">if</span> <span class="n">part2</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="n">part2</span> <span class="o">=</span> <span class="n">part2</span> <span class="o">+</span> <span class="n">expletives</span><span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">expletives</span><span class="p">))]</span>

<span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;/yell &quot;</span> <span class="o">+</span> <span class="n">part1</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">part2</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1">#do the pot thing</span>
<span class="n">output</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_key</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="c1">#increment the pot</span>
<span class="n">pot</span> <span class="o">=</span> <span class="n">pot</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;pot&quot;</span><span class="p">,</span><span class="n">pot</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>:
<a class="reference external" href="http://groups.google.com/groups/profile?enc_user=gy_J_BYAAABLTVwIPyUi9oJFSRwGwC70o4cocwWvDVg2RHsu8f1bCg">Dave</a></p>
<p><strong>Description</strong>: The Autokey script created here will allow you to
quickly screenshot your desktop while moving your mouse off to the
right. Dave had originally submitted it to the group forums there and at
least 4 of us helped him to modify it and make it faster.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># replace ~/Downloads with the location of where you told gnome-screenshot to save the pic</span>
<span class="c1">#</span>
<span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;bash -c &#39;rm ~/Downloads/today.png&#39;&quot;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;gnome-screenshot -w&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">wait_for_exist</span><span class="p">(</span><span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span> <span class="n">timeOut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;xte &#39;mousemove 725 399&#39;&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span> <span class="n">switchDesktop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;today&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: Jack</p>
<p><strong>Description</strong>: this script switches to the Firefox window. if Firefox
is not already running, the script starts it. i use similar scripts for
the applications i use most.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1">#start firefox or switch to firefox</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;wmctrl -l&#39;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">getOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;Firefox&#39;</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
    <span class="n">window</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="s1">&#39;Firefox&#39;</span><span class="p">,</span><span class="n">switchDesktop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;/usr/bin/firefox&quot;</span><span class="p">])</span>
<span class="c1">#</span>
</pre></div>
</div>
<p><strong>Author</strong>: mindfulsource</p>
<p><strong>Description</strong>: this script toggles the primary window of any
application like this example for Firefox. ‘winClass’ and binary path
will vary depending on your scenario. Install ‘xdotool’ package if
needed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;wmctrl -lx&#39;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">getOutput</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;Navigator.Firefox&#39;</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
    <span class="n">winClass</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_class</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">winClass</span> <span class="o">==</span> <span class="s1">&#39;Navigator.Firefox&#39;</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;xdotool windowminimize $(xdotool getactivewindow)&quot;</span><span class="p">,</span> <span class="n">getOutput</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s2">&quot;wmctrl -xa Navigator.Firefox&quot;</span><span class="p">,</span> <span class="n">getOutput</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;/usr/bin/firefox&quot;</span><span class="p">])</span>
<span class="c1">#</span>
</pre></div>
</div>
<p><strong>Author</strong>: Jack</p>
<p><strong>Description</strong>: several actions to go on the same key… i have this on
this script sends <code class="docutils literal notranslate"><span class="pre">'^+'</span></code> when in Firefox or Chromium to do a zoom in.
when i’m reading RSS feeds in Akregator, it sends <code class="docutils literal notranslate"><span class="pre">'='</span></code> to move to the
next unread item.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>

<span class="n">winTitle</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>

<span class="k">if</span> <span class="s1">&#39;Mozilla Firefox&#39;</span> <span class="ow">in</span> <span class="n">winTitle</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">elif</span> <span class="s1">&#39;Chromium&#39;</span> <span class="ow">in</span> <span class="n">winTitle</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">elif</span> <span class="s1">&#39;Akregator&#39;</span> <span class="ow">in</span> <span class="n">winTitle</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1">#</span>
</pre></div>
</div>
<p><strong>Author</strong>: Jack</p>
<p><strong>Description</strong>: here are 4 tiny scripts to move the active window left,
right, up, down. fwiw i have them on !Super+AppropriateArrow.</p>
<p><strong>Move Window Left</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># move active window left</span>
<span class="n">thisWin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">windetails</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_geometry</span><span class="p">()</span> <span class="c1"># returns tuple of: x, y, width, height</span>
<span class="n">newX</span> <span class="o">=</span> <span class="n">windetails</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">40</span>
<span class="n">window</span><span class="o">.</span><span class="n">resize_move</span><span class="p">(</span><span class="n">thisWin</span><span class="p">,</span> <span class="n">xOrigin</span><span class="o">=</span><span class="n">newX</span><span class="p">,</span> <span class="n">yOrigin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">matchClass</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Move Window Right</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># move active window right</span>
<span class="n">thisWin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">windetails</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_geometry</span><span class="p">()</span> <span class="c1"># returns tuple of: x, y, width, height</span>
<span class="n">newX</span> <span class="o">=</span> <span class="n">windetails</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">40</span>
<span class="n">window</span><span class="o">.</span><span class="n">resize_move</span><span class="p">(</span><span class="n">thisWin</span><span class="p">,</span> <span class="n">xOrigin</span><span class="o">=</span><span class="n">newX</span><span class="p">,</span> <span class="n">yOrigin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">matchClass</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Move Window Up</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># move active window up</span>
<span class="n">thisWin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">windetails</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_geometry</span><span class="p">()</span> <span class="c1"># returns tuple of: x, y, width, height</span>
<span class="n">newY</span><span class="o">=</span><span class="n">windetails</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">80</span> <span class="c1"># must bigger than approx 40, otherwise window moves down!</span>
<span class="n">window</span><span class="o">.</span><span class="n">resize_move</span><span class="p">(</span><span class="n">thisWin</span><span class="p">,</span> <span class="n">xOrigin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">yOrigin</span><span class="o">=</span><span class="n">newY</span><span class="p">,</span> <span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">matchClass</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Move Window Down</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># move active window down</span>
<span class="n">thisWin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">windetails</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_geometry</span><span class="p">()</span> <span class="c1"># returns tuple of: x, y, width, height</span>
<span class="n">oldY</span> <span class="o">=</span> <span class="n">windetails</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">newY</span><span class="o">=</span><span class="n">windetails</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span>
<span class="n">window</span><span class="o">.</span><span class="n">resize_move</span><span class="p">(</span><span class="n">thisWin</span><span class="p">,</span> <span class="n">xOrigin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">yOrigin</span><span class="o">=</span><span class="n">newY</span><span class="p">,</span> <span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">matchClass</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>:
<a class="reference external" href="http://groups.google.com/groups/profile?enc_user=wEhtURIAAAD4aTgqVkoh5XFntZCWEVBLD1eZzMt9YX5JjiuRxhHx-A">Joe</a></p>
<p><strong>Description</strong>: Changes <code class="docutils literal notranslate"><span class="pre">&lt;ctrl&gt;+p</span></code> for Mozilla applications to print
to a file in a special offline print queue using incremented file names,
intended for use with duplexpr.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##print2file</span>

<span class="c1">## Copyleft 2012/08/31 - Joseph J. Pollock JPmicrosystems GPL</span>
<span class="c1">## Last Modified 2019/05/16 - Handle new Mozilla print dialog</span>
<span class="c1">##    Added support for Waterfox</span>
<span class="c1">##</span>
<span class="c1">## Assign &lt;Super&gt;+p for Firefox and Thunderbird</span>
<span class="c1">## to print to file in a special print queue using</span>
<span class="c1">## numbered file names, 01, 02, ... so the print jobs stay in order</span>
<span class="c1">##</span>
<span class="c1">## The new file name/number will have the same number of digits as the highest</span>
<span class="c1">## existing file name/number with left zero padding</span>
<span class="c1">## Two digit file names/numbers is the default.</span>
<span class="c1">##</span>
<span class="c1">## You can &quot;seed&quot; the process using e.g. touch 0000 in an empty print queue</span>
<span class="c1">## Intended for use with duplexpr</span>
<span class="c1">## http://sourceforge.net/projects/duplexpr/</span>
<span class="c1">##</span>
<span class="c1">## User must manually create print queue directory (~/pq)</span>
<span class="c1">##</span>
<span class="c1">## Not sure about the following still being necessary, but it works</span>
<span class="c1">## Set all *.print_to_filename variables in prefs.js (about:config)</span>
<span class="c1">## to path to print queue/01.ps (or .pdf)</span>
<span class="c1">## e.g. /home/shelelia/pq/01.ps (or .pdf)</span>
<span class="c1">##</span>
<span class="c1">## Using Ctrl+P as the hotkey doesn&#39;t seem to work in Firefox any more</span>
<span class="c1">## Hotkey &lt;Super&gt;+p</span>
<span class="c1">## Window Filter .*Thunderbird.*|.*Mozilla.*|.*Waterfox.*</span>
<span class="c1">##</span>
<span class="c1">## Changes &lt;Super&gt;+p to</span>
<span class="c1">## Print to file and looks at the print queue (~/pq) - hard coded</span>
<span class="c1">## Finds the last print file number and increments it by one</span>
<span class="c1">## Also handles files ending in &quot;.pdf&quot; or &quot;.ps&quot;</span>
<span class="c1">## Doesn&#39;t send final &lt;Enter&gt; so additional options like Print Selection</span>
<span class="c1">## can be set by the user</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">filenum</span> <span class="p">():</span>
    <span class="c1">## Gets next file number</span>
    <span class="c1">## Set path to print queue</span>
    <span class="n">home</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;HOME&quot;</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">home</span> <span class="o">+</span> <span class="s2">&quot;/pq&quot;</span>  <span class="c1">## Change this if your print queue is elsewhere</span>
    <span class="c1">##print(&quot;path [&quot; + path + &quot;]&quot;)  ## debug</span>
    <span class="c1">## Get all the files in the print queue in a list</span>
    <span class="c1">## Handle filesystem error</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dirlist</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;EE&quot;</span>

    <span class="c1">## And sort it in reverse order</span>
    <span class="c1">## So the largest numbered file is first</span>
    <span class="n">dirlist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">## If there aren&#39;t any files then</span>
    <span class="c1">## Set last file to 0</span>
    <span class="c1">## else, set it to the last file with a valid number</span>
    <span class="c1">## Defend script against non-numeric file names</span>
    <span class="c1">## go down the reverse sorted list until a numeric one is found</span>
    <span class="n">fn</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1">## default to 2-digit file numbers</span>
    <span class="n">files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dirlist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">files</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">##print(&quot;Found [&quot; + str(files) + &quot;] files&quot;)  ## debug</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">files</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fn</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">dirlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1">##print(&quot;name [&quot; + name + &quot;]&quot;)  ## debug</span>
            <span class="c1">## regex for case insensitive replace of the last occurrence</span>
            <span class="c1">## of .pdf or .ps at the end of the string with nothing</span>
            <span class="c1">## if the file name has more than one, it&#39;s not one of ours</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.(?i)(pdf|ps)?$&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="c1">## Use the length of the one we found to set the zero padding length</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">fn</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1">## If no numeric file names were found</span>
    <span class="k">if</span> <span class="n">fn</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">fn</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
        <span class="c1">##print(&quot;fn [&quot; + fn + &quot;]&quot;)</span>

    <span class="c1">## left zero fill the file name to the same length as the one we found</span>
    <span class="c1">##print(&quot;fn [&quot; + fn + &quot;] digits [&quot; + str(digits) + &quot;]&quot;)  ## debug</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fn</span>

<span class="c1">### DEBUG</span>
<span class="c1">## This code is for standalone testing outside of AutoKey</span>

<span class="c1">##output = filenum()</span>
<span class="c1">##print(&quot;Next File Number is [&quot; + output + &quot;]&quot;)</span>
<span class="c1">##quit()</span>

<span class="c1">### DEBUG</span>

<span class="c1">## Open the File menu</span>
<span class="c1">## Only works if Main Menu bar is displayed</span>
<span class="c1">## If we&#39;re not using Ctrl+p for the hotkey any more,</span>
<span class="c1">## maybe we can use it instead of AlT+f,p</span>
<span class="c1">##keyboard.send_keys(&quot;&lt;alt&gt;+f&quot;)</span>
<span class="c1">##time.sleep(1.0)</span>
<span class="c1">#### Select Print</span>
<span class="c1">##keyboard.send_keys(&quot;p&quot;)</span>
<span class="c1">##time.sleep(1.0)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;ctrl&gt;+p&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">winTitle</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>

<span class="k">while</span> <span class="p">(</span><span class="n">winTitle</span> <span class="o">==</span> <span class="s2">&quot;Printing&quot;</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">winTitle</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>

<span class="c1">## error window processing - for when FF complains about</span>
<span class="c1">## not being able to print all elements of the page</span>
<span class="n">winTitle</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_title</span><span class="p">()</span>
<span class="n">winClass</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_active_class</span><span class="p">()</span>
<span class="k">if</span> <span class="n">winTitle</span> <span class="o">==</span> <span class="s2">&quot;Printer Error&quot;</span> <span class="ow">and</span> <span class="n">winClass</span> <span class="o">==</span> <span class="s2">&quot;Dialog.Firefox&quot;</span><span class="p">:</span>
   <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
   <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">winTitle</span> <span class="o">==</span> <span class="s2">&quot;Print Preview Error&quot;</span> <span class="ow">and</span> <span class="n">winClass</span> <span class="o">==</span> <span class="s2">&quot;Dialog.Firefox&quot;</span><span class="p">:</span>
   <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
   <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">winClass</span> <span class="o">==</span> <span class="s2">&quot;Dialog.Firefox&quot;</span><span class="p">:</span>
   <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
   <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1">## tab to the printer selection list, then to the top of the list</span>
<span class="c1">## which is the Print to File selection</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&lt;home&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1">## tab to the file name field and enter the print queue directory path</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">filenum</span><span class="p">()</span>

<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;ctrl&gt;+a&quot;</span><span class="p">)</span> <span class="c1">## New 2019/04/23</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PQ&quot;</span><span class="p">)</span> <span class="c1">## Change this if your print queue is elsewhere</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/bigbird/pq/&quot;</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="c1">## New 2019/04/23</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1">## complete the file name field in the select file dialog</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1">## Tab away from the File select button so the user can just press Enter</span>
<span class="c1">## But don&#39;t send an enter so the user can select</span>
<span class="c1">## other options before printing</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>:
<a class="reference external" href="http://groups.google.com/groups/profile?enc_user=x6tfARIAAAAifj82FffFIj7Xx_wp_F3B8rhlH0Pnl47z4AZhN98BFg">tpower21</a></p>
<p><strong>Description</strong>: Wrap selected text with one or two keys/sets of keys,
or output them if nothing’s selected, and keep your current clipboard.
Can call it using engine.run_script(description) then bind whatever’s
calling it to something.</p>
<p><strong>Real World Use</strong>: Highlight a load of text and that you need wrapped
in something. Possibly say quotes, brackets, braces, parens, pipes,
asterisks etc … That is why the script is in two parts so you can have
multiple assignments to the same engine.</p>
<p><strong>Alternate Use</strong>: Wrapping a load of text with words or phrases like
you would use in html, xml, etc … where <em>wrap</em> could be <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> and
<em>``wrap_close``</em> could be <code class="docutils literal notranslate"><span class="pre">&lt;/div&gt;</span></code>.</p>
<p><strong>binder script</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrap</span> <span class="o">=</span> <span class="s2">&quot;&lt;shift&gt;+9&quot;</span>
<span class="n">wrap_close</span> <span class="o">=</span> <span class="s2">&quot;&lt;shift&gt;+0&quot;</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run_script</span><span class="p">(</span><span class="s2">&quot;wrap_selection&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>script</strong>: wrap_selection</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># wrap_selection</span>
<span class="c1"># get keys</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">wrap</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">info_dialog</span><span class="p">(</span><span class="s2">&quot;Need at least one key to wrap selection with.&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">wrap_close</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">wrap_close</span> <span class="o">=</span> <span class="n">wrap</span>
<span class="c1"># below needed to get working in some apps, otherwise</span>
<span class="c1"># clipboard.get_selection() quicker/better</span>
<span class="c1"># get clipboard/selection</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">clip_board</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_clipboard</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">clip_board</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;ctrl&gt;+x&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_clipboard</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># clipboard won&#39;t update if selection empty</span>
<span class="k">if</span> <span class="n">clip_board</span> <span class="o">==</span> <span class="n">selection</span><span class="p">:</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1"># problem if clipboard and selection are the same</span>
<span class="c1"># and not empty, but not the end of the world</span>
<span class="c1"># wrap and clean up</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">wrap</span><span class="o">+</span><span class="n">selection</span><span class="o">+</span><span class="n">wrap_close</span><span class="o">+</span><span class="s2">&quot;&lt;left&gt;&quot;</span><span class="p">)</span>
<span class="c1">#tpower21 added the following two lines on February 7 2012</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
   <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;shift&gt;+&lt;left&gt;&quot;</span><span class="p">)</span>
<span class="n">clipboard</span><span class="o">.</span><span class="n">fill_clipboard</span><span class="p">(</span><span class="n">clip_board</span><span class="p">)</span>
<span class="k">del</span> <span class="n">clip_board</span><span class="p">,</span> <span class="n">selection</span><span class="p">,</span> <span class="n">wrap</span><span class="p">,</span> <span class="n">wrap_close</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="http://www.bowierocks.com">Itscool - Al</a></p>
<p><strong>Description</strong>: This AutoKey script takes a selected entry in your
WordPress article that may or may not contain parens “()”, extracts the
number enclosed and converts that to a link to the concordance at
eliyah.com. The number is assumed to be a HEBREW lexicon indicator as
pertains to the Strong’s Concordance that is keyed to the New King James
Bible. I have my hot-key combo set to “<code class="docutils literal notranslate"><span class="pre">&lt;alt&gt;+&lt;shift&gt;+h</span></code>”. With no
further ado I present the following Python script for AutoKey that does
what I claim.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="k">if</span> <span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">selection</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">if</span> <span class="n">selection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;alt&gt;+&lt;shift&gt;+a&quot;</span><span class="p">)</span>

<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;http://www.eliyah.com/cgi-bin/strongs.cgi?file=hebrewlexicon&amp;isindex=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">selection</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;Strong&#39;s Concordance HEBREW </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">selection</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: Joseph Pollock - JPmicrosystems</p>
<p><strong>Description:</strong>* Normally, AutoKey will emit characters from a
phrase or script as fast as the system will allow. This is quite a bit
faster than typing and some applications may not be able to keep up.</p>
<p>The following script emits/types a string of characters one at a time
with a delay between each one.</p>
<p>The first parameter is the string of characters to type. The second
optional parameter is the number of seconds to delay between each
keypress. It defaults to 0.1 seconds.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="c1">## Type a string character by character</span>
<span class="c1">##   from within AutoKey</span>
<span class="c1">##   with a small delay between characters</span>
<span class="k">def</span> <span class="nf">type_slow</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">delay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># No delay, directly relay the whole string to the API function.</span>
        <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
            <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: Chris Dardis</p>
<p><strong>Description:</strong>* This brings up your list of saved passwords at a
keystroke e.g. “CTRL + ALT + p” while using Firefox. This comes in handy
on a daily basis for me. There is a limit to how fast this will work, as
it involves tabbing on an active browser. Thus, the values for
time.sleep() below are perhaps a little conservative.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## menu - edit</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;alt&gt;+e&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1">## menu - preferences (opens new tab)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;passwords&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt; &lt;tab&gt; &lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;enter&gt;&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="s2">&quot;Confirm&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;alt&gt;+y&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1">## x7 total</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;tab&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: Jack</p>
<p><strong>Description</strong>: This script changes the case of selected text. Repeated
runs to this script cycle through Uppercase, Title Case, Lowercase:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HELLO</span> <span class="n">WORLD</span>
<span class="n">Hello</span> <span class="n">World</span>
<span class="n">hello</span> <span class="n">world</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Change case of selected text. Repeated runs to this script cycle through Uppercase, Title Case, Lowercase:</span>
<span class="c1">#   HELLO WORLD, Hello World, hello world</span>
<span class="c1">#</span>
<span class="c1"># jack</span>

<span class="c1"># Get the current selection.</span>
<span class="n">sText</span><span class="o">=</span><span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="n">lLength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sText</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">store</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;textCycle&quot;</span><span class="p">):</span>
        <span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>

<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># get saved value of textCycle</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;textCycle&quot;</span><span class="p">)</span>

<span class="c1">#dialog.info_dialog(title=&#39;state&#39;, message=state)</span>


<span class="c1"># modify text and set next modfication style</span>
<span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span>
    <span class="n">sText</span><span class="o">=</span><span class="n">sText</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
    <span class="n">newstate</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span>

<span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;lower&quot;</span><span class="p">:</span>
    <span class="n">sText</span><span class="o">=</span><span class="n">sText</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">newstate</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span>

<span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span>
    <span class="n">sText</span><span class="o">=</span><span class="n">sText</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">newstate</span> <span class="o">=</span> <span class="s2">&quot;title&quot;</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">newstate</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span>

<span class="c1"># save for next run of script</span>
<span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;textCycle&quot;</span><span class="p">,</span><span class="n">newstate</span><span class="p">)</span>



<span class="c1"># Send the result.</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">sText</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;shift&gt;+&lt;left&gt;&quot;</span><span class="o">*</span><span class="n">lLength</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: Kolibril13</p>
<p><strong>Description</strong>: This script opens the working directory, which you
define in “/home/username/Desktop/working_directory.txt” (Ubuntu 18.04)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/home/kolibril/Desktop/working_directory.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">working_directory</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">working_directory</span> <span class="o">=</span> <span class="n">working_directory</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;nautilus &quot;</span> <span class="o">+</span> <span class="n">working_directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://kreezcraft.com">Kreezxil</a></p>
<p><strong>Description</strong>: I created this to manage going to ip addresses that for
whatever reason aren’t named.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autokey.common</span> <span class="kn">import</span> <span class="n">USING_QT</span>

<span class="c1"># Maybe you don&#39;t want to set up a name server or you got some sites</span>
<span class="c1"># you goto that are just ips, w/e the reason this works too.</span>
<span class="n">ipaddresses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ipaddresses</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;my system&quot;</span><span class="p">,</span>  <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">])</span>
<span class="n">ipaddresses</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;Mom&#39;s PC&quot;</span><span class="p">,</span>  <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">])</span>
<span class="n">ipaddresses</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;John&#39;s Filth Can&quot;</span><span class="p">,</span>  <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">])</span>
<span class="c1"># clearly mom needs lots of remote work and nobody goes near john&#39;s filth can</span>

<span class="n">menuBuilder</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">defEntry</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">menuEntry</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ipaddresses</span><span class="p">:</span>
  <span class="n">entry</span><span class="o">=</span><span class="n">menuEntry</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">defEntry</span><span class="o">=</span><span class="n">entry</span>
  <span class="n">menuBuilder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

<span class="c1"># Gtk seems to easily support dimensions whereas QT not so much</span>
<span class="k">if</span> <span class="n">USING_QT</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;800&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;350&#39;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>

<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">ipaddresses</span><span class="p">[</span>
            <span class="n">menuBuilder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
        <span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">))</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://kreezcraft.com">Kreezxil</a></p>
<p><strong>Description</strong>: Post-it notes suck, writing on your hand sucks, using
various adware loaded programs suck. Why not write your own password
manager?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autokey.common</span> <span class="kn">import</span> <span class="n">USING_QT</span>

<span class="n">passMap1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># you should only have one line where the 4th element has the world &quot;default&quot;</span>
<span class="c1"># the last line to have default in it will be the default in the list</span>
<span class="c1"># these are all local ips obviously and the passwords are stupid (3rd element)</span>
<span class="c1"># on purpose</span>
<span class="c1"># some entries look like they are being used for titles, they are, good eye!</span>
<span class="n">passMap1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span>  <span class="s2">&quot;category&quot;</span><span class="p">,</span>  <span class="s2">&quot;title&quot;</span><span class="p">,</span>  <span class="s2">&quot;&quot;</span> <span class="p">])</span>
<span class="n">passMap1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span>  <span class="s2">&quot;       &quot;</span><span class="p">,</span>  <span class="s2">&quot;mom&quot;</span><span class="p">,</span>  <span class="s2">&quot;makescookies&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">])</span>
<span class="n">passMap1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span>  <span class="s2">&quot;       &quot;</span><span class="p">,</span>  <span class="s2">&quot;john&quot;</span><span class="p">,</span> <span class="s2">&quot;mybrother&quot;</span><span class="p">])</span>

<span class="n">menuBuilder</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">defEntry</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">menuEntry</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">passMap1</span><span class="p">:</span>
  <span class="n">entry</span><span class="o">=</span><span class="n">menuEntry</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
  <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">defEntry</span><span class="o">=</span><span class="n">entry</span>
  <span class="n">menuBuilder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

<span class="k">if</span> <span class="n">USING_QT</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;800&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;350&#39;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>

<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">passMap1</span><span class="p">[</span>
            <span class="n">menuBuilder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
        <span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="p">))</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://kreezcraft.com">Kreezxil</a></p>
<p><strong>Description</strong>: Similar to the password manager. As long as you have
sshpass installed and you are in the terminal this script will save your
fingers some major typing time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autokey.common</span> <span class="kn">import</span> <span class="n">USING_QT</span>

<span class="c1">#Required: sshpass</span>
<span class="c1">#        : and for you to be in the terminal already</span>

<span class="c1"># you should only have one line where the 4th element has the world &quot;default&quot;</span>
<span class="c1"># the last line to have default in it will be the default in the list</span>
<span class="c1"># these are all local ips obviously and the passwords are stupid (3rd element)</span>
<span class="c1"># on purpose</span>
<span class="n">systems</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>  <span class="s2">&quot;root&quot;</span><span class="p">,</span>  <span class="s2">&quot;reallyhardpasswordnot&quot;</span><span class="p">,</span>  <span class="s2">&quot;default&quot;</span><span class="p">])</span>
<span class="n">systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>  <span class="s2">&quot;mom&quot;</span><span class="p">,</span>  <span class="s2">&quot;makescookies&quot;</span><span class="p">])</span>
<span class="n">systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="s2">&quot;192.168.1.1&quot;</span><span class="p">,</span>  <span class="s2">&quot;john&quot;</span><span class="p">,</span>  <span class="s2">&quot;mybrother&quot;</span><span class="p">])</span>

<span class="n">menuBuilder</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">defEntry</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">menuEntry</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">:</span>
  <span class="n">entry</span><span class="o">=</span><span class="n">menuEntry</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
  <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">defEntry</span><span class="o">=</span><span class="n">entry</span>
  <span class="n">menuBuilder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

<span class="k">if</span> <span class="n">USING_QT</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">retCode</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">menuBuilder</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;800&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;350&#39;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">defEntry</span><span class="p">)</span>

<span class="k">if</span> <span class="n">retCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">command</span><span class="o">=</span><span class="s2">&quot;sshpass -p </span><span class="si">{}</span><span class="s2"> ssh -o StrictHostKeyChecking=no </span><span class="si">{}</span><span class="s2">@</span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">systems</span><span class="p">[</span><span class="n">menuBuilder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">choice</span><span class="p">)][</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">systems</span><span class="p">[</span><span class="n">menuBuilder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">choice</span><span class="p">)][</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">systems</span><span class="p">[</span><span class="n">menuBuilder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">choice</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">))</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://kreezcraft.com">Kreezxil</a></p>
<p><strong>Description</strong>: If you follow me you know that I have 100 projects at
<a class="reference external" href="https://www.curseforge.com/members/kreezxil/projects">https://www.curseforge.com/members/kreezxil/projects</a> and that I am
frequent updater of my modpacks. In order to build my changelogs after I
copy the download link I use a hot key to trigger this device to help me
paste a changelog.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">clipboard</span><span class="o">.</span><span class="n">get_clipboard</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="k">if</span> <span class="n">data</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
    <span class="n">dialog</span><span class="o">.</span><span class="n">info_dialog</span><span class="p">(</span><span class="s2">&quot;Empty&quot;</span><span class="p">,</span><span class="s2">&quot;The Clipboard is empty!&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">rawName</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">rawName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="n">theLink</span> <span class="o">=</span> <span class="s2">&quot;https://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">changeLog</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/files/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">theLink</span><span class="p">,</span><span class="n">parts</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">changeLog</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://askubuntu.com/a/685551/1058011">Slothworks</a></p>
<p><strong>Description</strong>: Being able to search any selected text by activating a
python script (below) everytime I pressed a set of keyboard buttons.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="n">base</span><span class="o">=</span><span class="s2">&quot;http://www.google.com/search?q=&quot;</span>
<span class="n">phrase</span><span class="o">=</span><span class="n">clipboard</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>

<span class="c1">#Remove trailing or leading white space and find if there are multiple</span>
<span class="c1">#words.</span>
<span class="n">phrase</span><span class="o">=</span><span class="n">phrase</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">singleWord</span><span class="o">=</span><span class="kc">False</span>
<span class="k">if</span> <span class="n">phrase</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">singleWord</span><span class="o">=</span><span class="kc">True</span>

<span class="c1">#Generate search URL.</span>
<span class="k">if</span> <span class="n">singleWord</span><span class="p">:</span>
    <span class="n">search_url</span><span class="o">=</span><span class="n">base</span><span class="o">+</span><span class="n">phrase</span>
<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">singleWord</span><span class="p">):</span>
    <span class="n">phrase</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">phrase</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">search_url</span><span class="o">=</span><span class="n">base</span><span class="o">+</span><span class="n">phrase</span>

<span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">search_url</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://github.com/caspx">Caspx</a></p>
<p><strong>Description</strong>: This script will help you to quickly find those old
sneaky phrases you can’t seem to find.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">walk</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>


<span class="c1"># very simple logger</span>
<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;echo &quot;</span><span class="si">{}</span><span class="s1">&quot; &gt;&gt; /tmp/autokey.log&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>


<span class="c1"># Location to Autokey data dir - You can set it manually</span>
<span class="n">USER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;USER&#39;</span><span class="p">)</span>
<span class="n">AUTOKEY_DATA_DIR</span> <span class="o">=</span> <span class="s1">&#39;/home/</span><span class="si">{}</span><span class="s1">/.config/autokey/data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">USER</span><span class="p">)</span>


<span class="c1"># List all phrases and scripts located in the data dir</span>
<span class="n">DATA_FILES</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="n">AUTOKEY_DATA_DIR</span><span class="p">):</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">))]</span>
    <span class="n">DATA_FILES</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>


<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ret_code</span><span class="p">,</span> <span class="n">query</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">input_dialog</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Search&quot;</span><span class="p">,</span>
                                          <span class="n">message</span><span class="o">=</span><span class="s1">&#39;Enter a query&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ret_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Currently check query against file path and name only</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">DATA_FILES</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">f</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># known issue - May run over a phrase with the same name</span>
            <span class="n">candidates</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>

    <span class="c1"># show a dialog list with what we have found</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">ret_code</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">list_menu</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span>
                                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Search&#39;</span><span class="p">,</span>
                                        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Results&#39;</span><span class="p">,</span>
                                        <span class="n">height</span><span class="o">=</span><span class="s2">&quot;500&quot;</span><span class="p">,</span>
                                        <span class="n">width</span><span class="o">=</span><span class="s2">&quot;400&quot;</span><span class="p">)</span>

    <span class="c1"># Printing the selected phrase</span>
    <span class="k">if</span> <span class="n">ret_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">choice</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">phrase</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
</pre></div>
</div>
<p><strong>Author</strong>: <a class="reference external" href="https://github.com/tomrule007">tomrule007</a></p>
<p><strong>Description</strong>: Sample script that uses global value to toggle hotkey
actions.</p>
<p>Enable script - sets enabled True and passes hotkey through.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store</span><span class="o">.</span><span class="n">set_global_value</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;&lt;escape&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Disable script - sets enabled False and passes hotkey through.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store</span><span class="o">.</span><span class="n">set_global_value</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">keyboard</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Action script - checks global value to determine action and also handles
unset global with a default setting.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_global_value</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">#default setting</span>

<span class="k">if</span> <span class="n">enabled</span><span class="p">:</span>
    <span class="c1"># Do this if enabled.</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Do this if disabled.</span>
</pre></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">AutoKey</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to Autokey</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Thomas Hess.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/Scripting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>